package kr.flab.wiki.lib.i18n

import java.util.Locale
import kotlin.collections.HashMap

/*
 * All Java Locales provides ISO 3166 alpha-2 country code unless using a custom Locale
 * Referenced from https://unstats.un.org/unsd/methodology/m49/
 * Nice conversion table found at: https://github.com/lukes/ISO-3166-Countries-with-Regional-Codes
 *
 * Type notation to ensure this collection is immutable even though a reference leakage happens
 */
private val COUNTRY_DATA: Map<String, List<String>> = HashMap<String, List<String>>().apply {
    // ALPHA-2    ->     ALPHA-3, Country, Region, rIntermediate, rSub
    put("AF", arrayListOf("AFG", "004", "142", "", "034"))
    put("AX", arrayListOf("ALA", "248", "150", "", "154"))
    put("AL", arrayListOf("ALB", "008", "150", "", "139"))
    put("DZ", arrayListOf("DZA", "012", "002", "", "015"))
    put("AS", arrayListOf("ASM", "016", "009", "", "061"))
    put("AD", arrayListOf("AND", "020", "150", "", "039"))
    put("AO", arrayListOf("AGO", "024", "002", "017", "202"))
    put("AI", arrayListOf("AIA", "660", "019", "029", "419"))
    put("AQ", arrayListOf("ATA", "010", "", "", ""))
    put("AG", arrayListOf("ATG", "028", "019", "029", "419"))
    put("AR", arrayListOf("ARG", "032", "019", "005", "419"))
    put("AM", arrayListOf("ARM", "051", "142", "", "145"))
    put("AW", arrayListOf("ABW", "533", "019", "029", "419"))
    put("AU", arrayListOf("AUS", "036", "009", "", "053"))
    put("AT", arrayListOf("AUT", "040", "150", "", "155"))
    put("AZ", arrayListOf("AZE", "031", "142", "", "145"))
    put("BS", arrayListOf("BHS", "044", "019", "029", "419"))
    put("BH", arrayListOf("BHR", "048", "142", "", "145"))
    put("BD", arrayListOf("BGD", "050", "142", "", "034"))
    put("BB", arrayListOf("BRB", "052", "019", "029", "419"))
    put("BY", arrayListOf("BLR", "112", "150", "", "151"))
    put("BE", arrayListOf("BEL", "056", "150", "", "155"))
    put("BZ", arrayListOf("BLZ", "084", "019", "013", "419"))
    put("BJ", arrayListOf("BEN", "204", "002", "011", "202"))
    put("BM", arrayListOf("BMU", "060", "019", "", "021"))
    put("BT", arrayListOf("BTN", "064", "142", "", "034"))
    put("BO", arrayListOf("BOL", "068", "019", "005", "419"))
    put("BQ", arrayListOf("BES", "535", "019", "029", "419"))
    put("BA", arrayListOf("BIH", "070", "150", "", "039"))
    put("BW", arrayListOf("BWA", "072", "002", "018", "202"))
    put("BV", arrayListOf("BVT", "074", "019", "005", "419"))
    put("BR", arrayListOf("BRA", "076", "019", "005", "419"))
    put("IO", arrayListOf("IOT", "086", "002", "014", "202"))
    put("BN", arrayListOf("BRN", "096", "142", "", "035"))
    put("BG", arrayListOf("BGR", "100", "150", "", "151"))
    put("BF", arrayListOf("BFA", "854", "002", "011", "202"))
    put("BI", arrayListOf("BDI", "108", "002", "014", "202"))
    put("CV", arrayListOf("CPV", "132", "002", "011", "202"))
    put("KH", arrayListOf("KHM", "116", "142", "", "035"))
    put("CM", arrayListOf("CMR", "120", "002", "017", "202"))
    put("CA", arrayListOf("CAN", "124", "019", "", "021"))
    put("KY", arrayListOf("CYM", "136", "019", "029", "419"))
    put("CF", arrayListOf("CAF", "140", "002", "017", "202"))
    put("TD", arrayListOf("TCD", "148", "002", "017", "202"))
    put("CL", arrayListOf("CHL", "152", "019", "005", "419"))
    put("CN", arrayListOf("CHN", "156", "142", "", "030"))
    put("CX", arrayListOf("CXR", "162", "009", "", "053"))
    put("CC", arrayListOf("CCK", "166", "009", "", "053"))
    put("CO", arrayListOf("COL", "170", "019", "005", "419"))
    put("KM", arrayListOf("COM", "174", "002", "014", "202"))
    put("CG", arrayListOf("COG", "178", "002", "017", "202"))
    put("CD", arrayListOf("COD", "180", "002", "017", "202"))
    put("CK", arrayListOf("COK", "184", "009", "", "061"))
    put("CR", arrayListOf("CRI", "188", "019", "013", "419"))
    put("CI", arrayListOf("CIV", "384", "002", "011", "202"))
    put("HR", arrayListOf("HRV", "191", "150", "", "039"))
    put("CU", arrayListOf("CUB", "192", "019", "029", "419"))
    put("CW", arrayListOf("CUW", "531", "019", "029", "419"))
    put("CY", arrayListOf("CYP", "196", "142", "", "145"))
    put("CZ", arrayListOf("CZE", "203", "150", "", "151"))
    put("DK", arrayListOf("DNK", "208", "150", "", "154"))
    put("DJ", arrayListOf("DJI", "262", "002", "014", "202"))
    put("DM", arrayListOf("DMA", "212", "019", "029", "419"))
    put("DO", arrayListOf("DOM", "214", "019", "029", "419"))
    put("EC", arrayListOf("ECU", "218", "019", "005", "419"))
    put("EG", arrayListOf("EGY", "818", "002", "", "015"))
    put("SV", arrayListOf("SLV", "222", "019", "013", "419"))
    put("GQ", arrayListOf("GNQ", "226", "002", "017", "202"))
    put("ER", arrayListOf("ERI", "232", "002", "014", "202"))
    put("EE", arrayListOf("EST", "233", "150", "", "154"))
    put("ET", arrayListOf("ETH", "231", "002", "014", "202"))
    put("FK", arrayListOf("FLK", "238", "019", "005", "419"))
    put("FO", arrayListOf("FRO", "234", "150", "", "154"))
    put("FJ", arrayListOf("FJI", "242", "009", "", "054"))
    put("FI", arrayListOf("FIN", "246", "150", "", "154"))
    put("FR", arrayListOf("FRA", "250", "150", "", "155"))
    put("GF", arrayListOf("GUF", "254", "019", "005", "419"))
    put("PF", arrayListOf("PYF", "258", "009", "", "061"))
    put("TF", arrayListOf("ATF", "260", "002", "014", "202"))
    put("GA", arrayListOf("GAB", "266", "002", "017", "202"))
    put("GM", arrayListOf("GMB", "270", "002", "011", "202"))
    put("GE", arrayListOf("GEO", "268", "142", "", "145"))
    put("DE", arrayListOf("DEU", "276", "150", "", "155"))
    put("GH", arrayListOf("GHA", "288", "002", "011", "202"))
    put("GI", arrayListOf("GIB", "292", "150", "", "039"))
    put("GR", arrayListOf("GRC", "300", "150", "", "039"))
    put("GL", arrayListOf("GRL", "304", "019", "", "021"))
    put("GD", arrayListOf("GRD", "308", "019", "029", "419"))
    put("GP", arrayListOf("GLP", "312", "019", "029", "419"))
    put("GU", arrayListOf("GUM", "316", "009", "", "057"))
    put("GT", arrayListOf("GTM", "320", "019", "013", "419"))
    put("GG", arrayListOf("GGY", "831", "150", "830", "154"))
    put("GN", arrayListOf("GIN", "324", "002", "011", "202"))
    put("GW", arrayListOf("GNB", "624", "002", "011", "202"))
    put("GY", arrayListOf("GUY", "328", "019", "005", "419"))
    put("HT", arrayListOf("HTI", "332", "019", "029", "419"))
    put("HM", arrayListOf("HMD", "334", "009", "", "053"))
    put("VA", arrayListOf("VAT", "336", "150", "", "039"))
    put("HN", arrayListOf("HND", "340", "019", "013", "419"))
    put("HK", arrayListOf("HKG", "344", "142", "", "030"))
    put("HU", arrayListOf("HUN", "348", "150", "", "151"))
    put("IS", arrayListOf("ISL", "352", "150", "", "154"))
    put("IN", arrayListOf("IND", "356", "142", "", "034"))
    put("ID", arrayListOf("IDN", "360", "142", "", "035"))
    put("IR", arrayListOf("IRN", "364", "142", "", "034"))
    put("IQ", arrayListOf("IRQ", "368", "142", "", "145"))
    put("IE", arrayListOf("IRL", "372", "150", "", "154"))
    put("IM", arrayListOf("IMN", "833", "150", "", "154"))
    put("IL", arrayListOf("ISR", "376", "142", "", "145"))
    put("IT", arrayListOf("ITA", "380", "150", "", "039"))
    put("JM", arrayListOf("JAM", "388", "019", "029", "419"))
    put("JP", arrayListOf("JPN", "392", "142", "", "030"))
    put("JE", arrayListOf("JEY", "832", "150", "830", "154"))
    put("JO", arrayListOf("JOR", "400", "142", "", "145"))
    put("KZ", arrayListOf("KAZ", "398", "142", "", "143"))
    put("KE", arrayListOf("KEN", "404", "002", "014", "202"))
    put("KI", arrayListOf("KIR", "296", "009", "", "057"))
    put("KP", arrayListOf("PRK", "408", "142", "", "030"))
    put("KR", arrayListOf("KOR", "410", "142", "", "030"))
    put("KW", arrayListOf("KWT", "414", "142", "", "145"))
    put("KG", arrayListOf("KGZ", "417", "142", "", "143"))
    put("LA", arrayListOf("LAO", "418", "142", "", "035"))
    put("LV", arrayListOf("LVA", "428", "150", "", "154"))
    put("LB", arrayListOf("LBN", "422", "142", "", "145"))
    put("LS", arrayListOf("LSO", "426", "002", "018", "202"))
    put("LR", arrayListOf("LBR", "430", "002", "011", "202"))
    put("LY", arrayListOf("LBY", "434", "002", "", "015"))
    put("LI", arrayListOf("LIE", "438", "150", "", "155"))
    put("LT", arrayListOf("LTU", "440", "150", "", "154"))
    put("LU", arrayListOf("LUX", "442", "150", "", "155"))
    put("MO", arrayListOf("MAC", "446", "142", "", "030"))
    put("MK", arrayListOf("MKD", "807", "150", "", "039"))
    put("MG", arrayListOf("MDG", "450", "002", "014", "202"))
    put("MW", arrayListOf("MWI", "454", "002", "014", "202"))
    put("MY", arrayListOf("MYS", "458", "142", "", "035"))
    put("MV", arrayListOf("MDV", "462", "142", "", "034"))
    put("ML", arrayListOf("MLI", "466", "002", "011", "202"))
    put("MT", arrayListOf("MLT", "470", "150", "", "039"))
    put("MH", arrayListOf("MHL", "584", "009", "", "057"))
    put("MQ", arrayListOf("MTQ", "474", "019", "029", "419"))
    put("MR", arrayListOf("MRT", "478", "002", "011", "202"))
    put("MU", arrayListOf("MUS", "480", "002", "014", "202"))
    put("YT", arrayListOf("MYT", "175", "002", "014", "202"))
    put("MX", arrayListOf("MEX", "484", "019", "013", "419"))
    put("FM", arrayListOf("FSM", "583", "009", "", "057"))
    put("MD", arrayListOf("MDA", "498", "150", "", "151"))
    put("MC", arrayListOf("MCO", "492", "150", "", "155"))
    put("MN", arrayListOf("MNG", "496", "142", "", "030"))
    put("ME", arrayListOf("MNE", "499", "150", "", "039"))
    put("MS", arrayListOf("MSR", "500", "019", "029", "419"))
    put("MA", arrayListOf("MAR", "504", "002", "", "015"))
    put("MZ", arrayListOf("MOZ", "508", "002", "014", "202"))
    put("MM", arrayListOf("MMR", "104", "142", "", "035"))
    put("NA", arrayListOf("NAM", "516", "002", "018", "202"))
    put("NR", arrayListOf("NRU", "520", "009", "", "057"))
    put("NP", arrayListOf("NPL", "524", "142", "", "034"))
    put("NL", arrayListOf("NLD", "528", "150", "", "155"))
    put("NC", arrayListOf("NCL", "540", "009", "", "054"))
    put("NZ", arrayListOf("NZL", "554", "009", "", "053"))
    put("NI", arrayListOf("NIC", "558", "019", "013", "419"))
    put("NE", arrayListOf("NER", "562", "002", "011", "202"))
    put("NG", arrayListOf("NGA", "566", "002", "011", "202"))
    put("NU", arrayListOf("NIU", "570", "009", "", "061"))
    put("NF", arrayListOf("NFK", "574", "009", "", "053"))
    put("MP", arrayListOf("MNP", "580", "009", "", "057"))
    put("NO", arrayListOf("NOR", "578", "150", "", "154"))
    put("OM", arrayListOf("OMN", "512", "142", "", "145"))
    put("PK", arrayListOf("PAK", "586", "142", "", "034"))
    put("PW", arrayListOf("PLW", "585", "009", "", "057"))
    put("PS", arrayListOf("PSE", "275", "142", "", "145"))
    put("PA", arrayListOf("PAN", "591", "019", "013", "419"))
    put("PG", arrayListOf("PNG", "598", "009", "", "054"))
    put("PY", arrayListOf("PRY", "600", "019", "005", "419"))
    put("PE", arrayListOf("PER", "604", "019", "005", "419"))
    put("PH", arrayListOf("PHL", "608", "142", "", "035"))
    put("PN", arrayListOf("PCN", "612", "009", "", "061"))
    put("PL", arrayListOf("POL", "616", "150", "", "151"))
    put("PT", arrayListOf("PRT", "620", "150", "", "039"))
    put("PR", arrayListOf("PRI", "630", "019", "029", "419"))
    put("QA", arrayListOf("QAT", "634", "142", "", "145"))
    put("RE", arrayListOf("REU", "638", "002", "014", "202"))
    put("RO", arrayListOf("ROU", "642", "150", "", "151"))
    put("RU", arrayListOf("RUS", "643", "150", "", "151"))
    put("RW", arrayListOf("RWA", "646", "002", "014", "202"))
    put("BL", arrayListOf("BLM", "652", "019", "029", "419"))
    put("SH", arrayListOf("SHN", "654", "002", "011", "202"))
    put("KN", arrayListOf("KNA", "659", "019", "029", "419"))
    put("LC", arrayListOf("LCA", "662", "019", "029", "419"))
    put("MF", arrayListOf("MAF", "663", "019", "029", "419"))
    put("PM", arrayListOf("SPM", "666", "019", "", "021"))
    put("VC", arrayListOf("VCT", "670", "019", "029", "419"))
    put("WS", arrayListOf("WSM", "882", "009", "", "061"))
    put("SM", arrayListOf("SMR", "674", "150", "", "039"))
    put("ST", arrayListOf("STP", "678", "002", "017", "202"))
    put("SA", arrayListOf("SAU", "682", "142", "", "145"))
    put("SN", arrayListOf("SEN", "686", "002", "011", "202"))
    put("RS", arrayListOf("SRB", "688", "150", "", "039"))
    put("SC", arrayListOf("SYC", "690", "002", "014", "202"))
    put("SL", arrayListOf("SLE", "694", "002", "011", "202"))
    put("SG", arrayListOf("SGP", "702", "142", "", "035"))
    put("SX", arrayListOf("SXM", "534", "019", "029", "419"))
    put("SK", arrayListOf("SVK", "703", "150", "", "151"))
    put("SI", arrayListOf("SVN", "705", "150", "", "039"))
    put("SB", arrayListOf("SLB", "090", "009", "", "054"))
    put("SO", arrayListOf("SOM", "706", "002", "014", "202"))
    put("ZA", arrayListOf("ZAF", "710", "002", "018", "202"))
    put("GS", arrayListOf("SGS", "239", "019", "005", "419"))
    put("SS", arrayListOf("SSD", "728", "002", "014", "202"))
    put("ES", arrayListOf("ESP", "724", "150", "", "039"))
    put("LK", arrayListOf("LKA", "144", "142", "", "034"))
    put("SD", arrayListOf("SDN", "729", "002", "", "015"))
    put("SR", arrayListOf("SUR", "740", "019", "005", "419"))
    put("SJ", arrayListOf("SJM", "744", "150", "", "154"))
    put("SZ", arrayListOf("SWZ", "748", "002", "018", "202"))
    put("SE", arrayListOf("SWE", "752", "150", "", "154"))
    put("CH", arrayListOf("CHE", "756", "150", "", "155"))
    put("SY", arrayListOf("SYR", "760", "142", "", "145"))
    put("TW", arrayListOf("TWN", "158", "142", "", "030"))
    put("TJ", arrayListOf("TJK", "762", "142", "", "143"))
    put("TZ", arrayListOf("TZA", "834", "002", "014", "202"))
    put("TH", arrayListOf("THA", "764", "142", "", "035"))
    put("TL", arrayListOf("TLS", "626", "142", "", "035"))
    put("TG", arrayListOf("TGO", "768", "002", "011", "202"))
    put("TK", arrayListOf("TKL", "772", "009", "", "061"))
    put("TO", arrayListOf("TON", "776", "009", "", "061"))
    put("TT", arrayListOf("TTO", "780", "019", "029", "419"))
    put("TN", arrayListOf("TUN", "788", "002", "", "015"))
    put("TR", arrayListOf("TUR", "792", "142", "", "145"))
    put("TM", arrayListOf("TKM", "795", "142", "", "143"))
    put("TC", arrayListOf("TCA", "796", "019", "029", "419"))
    put("TV", arrayListOf("TUV", "798", "009", "", "061"))
    put("UG", arrayListOf("UGA", "800", "002", "014", "202"))
    put("UA", arrayListOf("UKR", "804", "150", "", "151"))
    put("AE", arrayListOf("ARE", "784", "142", "", "145"))
    put("GB", arrayListOf("GBR", "826", "150", "", "154"))
    put("US", arrayListOf("USA", "840", "019", "", "021"))
    put("UM", arrayListOf("UMI", "581", "009", "", "057"))
    put("UY", arrayListOf("URY", "858", "019", "005", "419"))
    put("UZ", arrayListOf("UZB", "860", "142", "", "143"))
    put("VU", arrayListOf("VUT", "548", "009", "", "054"))
    put("VE", arrayListOf("VEN", "862", "019", "005", "419"))
    put("VN", arrayListOf("VNM", "704", "142", "", "035"))
    put("VG", arrayListOf("VGB", "092", "019", "029", "419"))
    put("VI", arrayListOf("VIR", "850", "019", "029", "419"))
    put("WF", arrayListOf("WLF", "876", "009", "", "061"))
    put("EH", arrayListOf("ESH", "732", "002", "", "015"))
    put("YE", arrayListOf("YEM", "887", "142", "", "145"))
    put("ZM", arrayListOf("ZMB", "894", "002", "014", "202"))
    put("ZW", arrayListOf("ZWE", "716", "002", "014", "202"))
}

/**
 * Converts given [Locale] to regional locale code defined in
 * [UN M.49](https://en.wikipedia.org/wiki/UN_M.49) codes.
 *
 * This method is a poor man's version of [com.ibm.icu.util.Region].
 *
 * @author Francesco Jo(nimbusob@gmail.com)
 * @since 25 - Jun - 2018
 * @return A locale with UN M.49 country code if a valid ISO 3166 alpha-2 code is given,
 *         will do nothing otherwise.
 */
@Suppress("MagicNumber")
fun Locale.toRegional(): Locale = toRegionalInternal(2)

/**
 * Converts given [Locale] to sub-regional locale code defined in
 * [UN M.49](https://en.wikipedia.org/wiki/UN_M.49) codes.
 *
 * This method is a poor man's version of [com.ibm.icu.util.Region].
 *
 * @author Francesco Jo(nimbusob@gmail.com)
 * @since 25 - Jun - 2018
 * @return A locale with UN M.49 country code if a valid ISO 3166 alpha-2 code is given,
 * will do nothing otherwise.
 */
@Suppress("MagicNumber")
fun Locale.toSubRegional(): Locale = toRegionalInternal(4)

private fun Locale.toRegionalInternal(idx: Int): Locale {
    val data = COUNTRY_DATA[country] ?: return this
    val subRegion = data[idx]

    return if (subRegion.isEmpty()) {
        this
    } else {
        Locale(language, subRegion)
    }
}
